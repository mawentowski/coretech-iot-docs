<div class="title-box">
    <h1 class="topic-title">Bagdrop API Tutorial</h1>
    <div class="action-statement">
        Follow the step-by-step instructions to complete an interaction with a
        bagdrop device.
    </div>
</div>

<h2 id="bagdrop-api-walkthrough">Bagdrop API Tutorial</h2>
<p>
    Follow along with this walkthrough to experience the Bagdrop API, including
    connecting to an SBD and completing an entire bagdrop process that ends with
    releasing the bag to the Baggage Handling System (BHS).
</p>
<p>The following tools are used to demonstrate the Print API:</p>
<ul>
    <li>
        The
        <a href="/get-started/test-environments/set-up-VM"
            >Citrix Virtualized SITA Flex Environment</a
        >
        to add devices.
    </li>
    <li>
        The SITA Flex API Postman Collection that allows you to send requests to
        Flex.
    </li>
    <li>
        Your airline backend to receive messages from the Azure Service Bus.
    </li>
</ul>
<div class="alert-section info-alert">
    <div class="">
        <p>
            This walkthrough provides some basic troubleshooting steps. However,
            if an error displays that is not covered, refer to the
            <a href="get-started/troubleshooting/environments"
                >Troubleshooting Environments</a
            >
            or
            <a href="get-started/troubleshooting/error-codes"
                >Troubleshooting Error Codes</a
            >
            sections for detailed steps on how to resolve the issue.
        </p>
    </div>
</div>
<h2 id="prerequisite-steps-3">Prerequisite Steps</h2>
<ol>
    <li>
        Login to the
        <a href="/get-started/test-environments/set-up-VM"
            >Citrix Virtualized SITA FlexÂ Environment</a
        >
        you set up previously.
    </li>
    <li>
        In Postman, open the <strong>SITA Flex API Collection</strong> and
        <strong>Postman environment</strong>
        <code class="inline-code">.json</code> files. In the Postman environment
        file:
        <ul>
            <li>
                Ensure your <code class="inline-code">clientid</code> and
                <code class="inline-code">clientsecret</code> are populated in
                both the <strong>Initial Value</strong> and
                <strong>Current Value</strong> columns.
            </li>
            <li>
                Ensure the
                <code class="inline-code">{{location}}</code> variable
                corresponds to the VM's machine name as seen in the Peripheral
                View. For example, a VM with machine name
                <code class="inline-code">ZZU1CKB005</code> as seen in the
                Peripheral view could correspond to a
                <code class="inline-code">location</code> called
                <code class="inline-code">A-ZZU-MZUZUAIRPORT-ZZU1CKB005</code>
                in the Postman Environment.
            </li>
        </ul>
    </li>
    <li>
        In Postman, perform the following:
        <ul>
            <li>Send a Get Access token request.</li>
            <li>
                Send a <span class="method post">POST</span>
                <code class="inline-code">/session/v2/subscriptions</code>
                request.
            </li>
            <li>
                Send a <span class="method post">POST</span>
                <code class="inline-code">/site/v2/reservations</code>
                request.
            </li>
        </ul>
    </li>
</ol>
<h2 id="add-an-sbd-device">Add an SBD Device</h2>
<div class="alert-section info-alert">
    <div class="">
        <p>If an SBD has already been added, skip this section.</p>
    </div>
    <ol>
        <li>
            In the Device Simulator of the VM, click
            <strong>Add Device</strong>.
        </li>
    </ol>
</div>

<p class="caption">Add an SBD in Device Simulator</p>
<ol>
    <li>
        <p>
            Select <strong>SBD</strong> from the
            <strong>Device Type</strong> drop-down.
        </p>
    </li>
    <li><p>Leave the other settings as is.</p></li>
    <li>
        <p>Click <strong>Add Device</strong>.</p>
        <ul>
            <li>The SBD is now available in the Device Simulator.</li>
            <li>
                By default, the SBD does not have a door. To trigger
                door-related Service Bus messages, you will add a door to the
                SBD in the following steps.
            </li>
        </ul>
    </li>
    <li>
        <p>
            On the device, click <strong>Options</strong>, then
            <strong>Settings</strong>.
        </p>
    </li>
    <li>
        <p>
            Click the <strong>SBD Bag Door</strong> drop-down and select
            <strong>(1) Door is installed</strong>.
        </p>
    </li>

    <!-- <p class="caption">
    SBD Bag Door Setting set to
    <code class="inline-code">Door is installed</code>
</p> -->

    <li>Click <strong>Save and Close</strong>.</li>
    <li>
        On the device, click <strong>Run</strong>.
        <ul>
            <li>
                An SBD Device Simulator screen displays. You may keep it open
                for later use.
            </li>
        </ul>
    </li>
</ol>
<h2 id="connect-to-the-sbd">Connect to the SBD</h2>
<ol>
    <li>
        In Postman, send a
        <code class="inline-code">/session/v2/connections</code> request to
        connect to the SBD.
        <ul>
            <li>
                After connecting to a device, a connection
                <code class="inline-code">expiryTime</code> is returned in the
                Response Body set to <strong>30 minutes</strong> from the time
                the
                <code class="inline-code">session/v2/connections</code>
                request was made.
            </li>
        </ul>
    </li>

    <div class="alert-section info-alert">
        <div class="">
            <p>
                Notice in the Request Body that the
                <code class="inline-code">DeviceId</code> will be populated
                based by the variable
                <code class="inline-code">{{location}}</code> in the Postman
                environment.
            </p>
        </div>
    </div>

    <li>
        Check the Service Bus subscription for a
        <code class="inline-code">BagdropDeviceStatus</code> message shown
        below.
    </li>
</ol>

<div class="method-example atom-one-light">
    <div class="method-example-top-bar">Service Bus Message</div>
    <pre><code class="language-json">
        {
            "DeviceStatus": "Online",
            "DeviceInUse": false
        } 
        </code>
        </pre>
</div>

<p class="caption">
    <code class="inline-code">BagdropDeviceStatus</code> Service Bus Message
    indicating the device is <code class="inline-code">Online</code> and not
    exclusively reserved
</p>
<p>
    The message should indicate the SBD is
    <code class="inline-code">Online</code> and is not exclusively being used
    (<code>"DeviceInUse": "false"</code>). The device is available to
    successfully receive a
    <code class="inline-code">/bagdrop/v2/getbag</code> request.
</p>
<div class="alert-section info-alert">
    <div class="">
        <p>
            In the Tests tab of Postman, there is a Javascript function that
            updates the
            <code class="inline-code">sbd_connection_id</code>
            environmental variable after connecting to the SBD. This variable
            makes it so you do not need to manually enter a
            <code class="inline-code">connectionId</code> in subsequent calls to
            the bagdrop API.
        </p>
    </div>
</div>
<h3 id="devicestatus-is-offline-3">
    <code class="inline-code">DeviceStatus</code> is
    <code class="inline-code">Offline</code>
</h3>
<p>
    If the <code class="inline-code">DeviceStatus</code> returns as
    <code class="inline-code">Offline</code>, check to see if the device is
    running in the Device Simulator. If there is a <strong>Stop</strong> button
    on the device in Device Simulator, the device is running.
</p>
<p>
    <em>If <u>it is not</u> running:</em>
</p>
<ol>
    <li>Click <strong>Run</strong>.</li>
    <li>
        In the Peripheral View, check to see if the SBD
        <strong>Status</strong> is now <code class="inline-code">Online</code>.
    </li>

    <p>
        <em>If <u>it is</u> running</em>, from the Device Simulator on the VM:
    </p>

    <li>Click <strong>Stop</strong>.</li>
    <li>Click <strong>Run</strong>.</li>
    <li>
        In the Peripheral View, check to see if the SBD
        <strong>Status</strong> is now <code class="inline-code">Online</code>.
    </li>
</ol>
<h2 id="initiate-a-bag-drop-process">Initiate a Bag Drop Process</h2>
<ol>
    <li>
        In Postman, send a
        <code class="inline-code">/bagdrop/v2/getbag</code>
        request.
        <ul>
            <li>
                The Bagdrop API acknowledges the request by returning a
                <code class="inline-code">2xx</code> success status code, as
                seen in a tool like Postman.
            </li>
            <li>
                If you added a door to the SBD earlier, notice that the door
                icon disappeared in the SBD Device Simulator. This simulates the
                door opening on a real bagdrop after a bagdrop process was
                initiated.
            </li>
        </ul>
    </li>
</ol>

<p class="caption">
    Device Simulator showing an 'opened door' after sending a
    <code class="inline-code">/bagdrop/v2/getbag</code> request
</p>
<div class="alert-section info-alert">
    <div class="">
        <p>
            On a real bag drop, a message such as "Please place your bag on the
            belt" would display.
        </p>
    </div>
</div>
<ul>
    <li>
        An updated
        <code class="inline-code">BagdropDeviceStatus</code>
        message displays on the Service Bus, indicating the SBD is now 'In Use'.
    </li>
</ul>

<div class="method-example atom-one-light">
    <div class="method-example-top-bar">Service Bus Message</div>
    <pre><code class="language-json">
{
    "DeviceStatus": "Online",
    "DeviceInUse": true
}
        </code>
        </pre>
</div>

<p class="caption">
    <code class="inline-code">BagdropDeviceStatus</code>
    Service Bus Message indicating the device is now exclusively reserved
</p>
<ul>
    <li>
        A
        <code class="inline-code">DoorOpening</code> message displays on the
        Service Bus with an empty Message Body. This simply indicates the door
        of the SBD has opened.
    </li>
    <li>
        A
        <code class="inline-code">GetBagResponse</code>
        message displays on the Service Bus which is an indication the bagdrop
        process is initiated. The property
        <code class="inline-code">"Bag": null</code>
        indicates there is no bag information because, for the purpose of this
        simulation, the passenger has not yet placed a bag onto the belt.
    </li>
</ul>

<div class="method-example atom-one-light">
    <div class="method-example-top-bar">Service Bus Message</div>
    <pre><code class="language-json">
{
    "Bag": null,
    "IsSuccess": true,
    "Error": null
}  
        </code>
        </pre>
</div>

<p class="caption">
    <code class="inline-code">GetBagResponse</code> Service Bus Message
    indicating no baggage data has been collected
</p>
<h3 id="timeout-at-entry-area-1">Timeout at Entry Area</h3>
<p>
    A
    <code class="inline-code">BagDropTransactionTimeout</code>
    message displays on the service bus with an empty Message Body when too much
    time has elapsed since the
    <code class="inline-code">/bagdrop/v2/getbag</code>
    request was made. Another
    <code class="inline-code">/bagdrop/v2/getbag</code>
    request must be made to restart the bagdrop process. If you send a
    <code class="inline-code">/bagdrop/v2/processbag</code>
    request when a timeout has occurred, and you have not sent the
    <code class="inline-code">/bagdrop/v2/getbag</code>
    request, you will receive an error status code.
</p>
<h2 id="place-a-bag-on-the-belt">Place a Bag on the Belt</h2>
<ol>
    <li>
        <p>
            With the SBD Device Simulator open, click
            <strong>New Bag</strong>.
        </p>

        <ul>
            <li>A <strong>New Bag</strong> window displays.</li>
        </ul>
    </li>
    <li><p>Leave all settings as is.</p></li>
    <li>
        <p>Click <strong>Create Bag</strong>.</p>
        <ul>
            <li>A new <strong>Bag #</strong> panel is displayed.</li>
        </ul>
    </li>

    <div class="alert-section info-alert">
        <div class="">
            <p>
                The bag in its current state is simulating the passenger holding
                the bag prior to placing the bag on the belt.
            </p>
        </div>
    </div>

    <li>
        Ensure the door is open (not red).
        <ul>
            <li>
                If the door has turned red (door is closed), send another
                <code class="inline-code">/bagdrop/v2/getbag</code>
                request to open it.
            </li>
        </ul>
    </li>
    <li>
        Click <strong>Place Selected Bag</strong> next to the New Bag button you
        clicked earlier (see previous screenshot).
        <ul>
            <li>
                The bag (in green) displays in the SBD image in the
                <strong>Entry Area</strong> like when a real bag is placed by a
                passenger in the <strong>Entry Area</strong> of an SBD.
            </li>
            <li>
                The
                <strong>Weight Scale Status</strong>
                (below the purple belt) displays
                <strong>Scale is debouncing</strong>
                (you must look quickly to see it), then
                <strong>Scale is settled</strong> after a few seconds to
                indicate the settled weight has been determined.
            </li>
        </ul>
    </li>
</ol>
<div class="alert-section info-alert">
    <div class="">
        <p>
            If the passenger is using a mobile app, the app may request
            confirmation that the bag has been placed by displaying a "I have
            placed the bag" prompt. After tapping the button, the passenger is
            brought to the next step in the bagdrop process.
        </p>
    </div>
</div>
<h2 id="view-settled-weight">View Settled Weight</h2>
<p>
    In the SBD Device Simulator, notice above the
    <strong>New Bag</strong> and <strong>Place Selected Bag</strong> buttons is
    a field with two properties called <strong>Bounce</strong>.
</p>
<p>
    In the previous step, you placed a bag onto the belt. When this occurred,
    the belt was 'in-motion' while the weight on the belt settled, like a real
    bag drop. The
    <strong>Bounce</strong> properties simulate the fluctuation of weight while
    the weight of the bag settles.
</p>
<p>
    The settled weight is calculated after the specified number of balancing
    events (<strong>5</strong>
    by default) has occurred.
</p>

<p class="caption">
    SBD Device Simulator showing
    <code class="inline-code">Bounce</code>
    Properties that simulate the motion of the belt after placing a bag
</p>
<p>To view the settled weight:</p>
<ol>
    <li>
        Click the
        <strong>Session History</strong> tab.
    </li>
</ol>

<p>
    In the Session History log, notice that the
    <strong>Bounce</strong> events are shown. For each event, a weight
    measurement is taken. Within the characters of the event string,
    <code class="inline-code">SW=2</code> means the bag is still settling on the
    weight scale. Notice how from one event to the next, the weight goes up and
    down, indicated by the <code class="inline-code">CW=</code> value. For
    example, one measurement could be
    <code class="inline-code">CW=23.8</code> then the next could be
    <code class="inline-code">CW=24.5</code>.
</p>
<p>
    In the last event, the
    <code class="inline-code">SW=4</code> indicates this measurement is the
    final measurement taken when the bag has settled and not in motion.
</p>
<p>
    A
    <code class="inline-code">BagPlaced</code>
    message displays on the Service Bus once a settled weight is determined:
</p>

<div class="method-example atom-one-light">
    <div class="method-example-top-bar">Service Bus Message</div>
    <pre><code class="language-json">
{
    "Bag": {
        "Tags": [],
        "Weight": {
            "Amount": 23.8,
            "Unit": "Kg"
        },
        "Position": "Entry",
        "VolumeResult": {
            "Width": {
                "Amount": 0.0,
                "Unit": "Cm"
            },
            "Height": {
                "Amount": 0.0,
                "Unit": "Cm"
            },
            "Length": {
                "Amount": 0.0,
                "Unit": "Cm"
            },
            "TubDetection": "NoTub"
        }
    },
    "IsSuccess": true,
    "Error": null
}
        </code>
        </pre>
</div>

<p class="caption">
    <code class="inline-code">BagPlaced</code>
    Service Bus message displaying properties of the 'placed bag'
</p>
<p>
    The
    <code class="inline-code">"Position": "Entry"</code>
    indicates that the bag is currently located on the
    <code class="inline-code">Entry</code> position of the SBD unit.
</p>
<div class="alert-section info-alert">
    <div class="">
        <p>
            The
            <code class="inline-code">Position</code>
            will update when new measurements are made as the bagdrop process
            progresses and the position of the bag changes.
        </p>
    </div>
</div>
<p>
    <code class="inline-code">"IsSuccess": true</code>
    indicates that a bag has been placed on the belt, and a settled weight has
    been calculated for the bag, in addition to other measurements such as the
    dimensions of the bag.
</p>
<div class="alert-section info-alert">
    <div class="">
        <p>
            The SBD device in the SBD Device Simulator is not capable of
            providing a the
            <code class="inline-code">VolumeResult</code>
            that includes the baggage dimensions, returning
            <code class="inline-code">"Amount": 0.0</code>
            for the various dimensions. However, some SBDs have this capability.
            When interacting with an actual SBD with the capability to take
            measurements, those measurements will display. How your airline
            backend could use this information is to potentially reject a bag if
            a bag's
            <code class="inline-code">width</code>
            is greater than a certain allowed amount, for example.
        </p>
    </div>
</div>
<h2 id="process-the-bag">Process the Bag</h2>
<ol>
    <li>
        In Postman, send a
        <code class="inline-code">/bagdrop/v2/processbag</code>
        request.
        <ul>
            <li>
                The Bagdrop API acknowledges the request by returning a
                <code class="inline-code">2xx</code>
                success status code, as seen in a tool such as Postman.
            </li>
            <li>
                In the SBD Device Simulator, notice that the door has closed,
                and the bag has now moved from the
                <code class="inline-code">Entry</code>
                position to the
                <code class="inline-code">Process</code>
                position to simulate the belt moving down the bag. The bag is
                not accessible to the passenger in this position.
            </li>
        </ul>
    </li>
</ol>

<p class="caption">
    Device Simulator showing the bag has moved to the Processing Area
</p>
<div class="alert-section info-alert">
    <div class="">
        <p>
            On a real bag drop, a message such as "Processing Bag, please wait."
            would display and the door to the bag drop would close (if not
            already closed).
        </p>
    </div>
</div>
<ul>
    <li>
        A
        <code class="inline-code">DoorClosing</code>
        message may display on the Service Bus with an empty Message Body. This
        indicates the door has closed after the passenger placed the bag on the
        belt.
    </li>
    <li>
        A
        <code class="inline-code">BagChanged</code>
        message displays on the Service Bus which indicates the bag has changed
        position. This message looks like the
        <code class="inline-code">BagPlaced</code>
        message, except with the property
        <code class="inline-code">Position</code>
        set to
        <code class="inline-code">Process</code>.
    </li>
</ul>
<div class="alert-section info-alert">
    <div class="">
        <p>
            In the simulation, the same baggage information collected from the
            measurement taken in the
            <strong>Entry Area</strong>
            is displayed in the
            <code class="inline-code">BagChanged</code>
            message. However, on a real bagdrop, it is possible the baggage
            information may change. For example, the SBD may be configured to
            take a measurement in the
            <strong>Processing Area</strong>
            rather than
            <strong>Entry Area</strong>. Or another measurement may be made in
            the Processing Area that updates the measurements.
        </p>
    </div>
</div>
<ul>
    <li>
        A
        <code class="inline-code">ProcessBagResponse</code>
        message displays on the Service Bus that indicates the bag was
        successfully processed (<code>"IsSuccess": true</code>). This message,
        like the
        <code class="inline-code">Bag Placed</code>
        and
        <code class="inline-code">BagChanged</code>
        messages, displays the baggage measurements.
    </li>
</ul>
<h3 id="not-enough-time-remaining-on-connection">
    Not enough time remaining on connection
</h3>
<p>
    A Bagdrop API returns a
    <code class="inline-code">400 Bad Request</code>
    error status code when the connection to a device is soon to reach its
    30-minute
    <code class="inline-code">expiryTime</code>
    set after the POST
    <code class="inline-code">/session/v2/connections</code>
    was made.
</p>

<div class="method-example atom-one-light">
    <div class="method-example-top-bar">Service Bus Message</div>
    <pre><code class="language-json">
{
    "type": "https://tools.ietf.org/html/rfc7231#section-6.5.1",
    "title": "Bad Request",
    "status": 400,
    "detail": "Not enough time remaining on connection.",
    "traceId": "00-baf5325b0757fc408018bca88119a826-65e7e75f65b69c4a-00"
} 
        </code>
        </pre>
</div>

<p class="caption">The connection to the device is soon to be expired</p>
<p>
    The resolution is to simply send another
    <code class="inline-code">session/v2/connections</code>
    request to create a new connection and receive a new
    <code class="inline-code">expiryTime</code>.
</p>
<h3 id="timeout-at-process-area-1">Timeout at Process Area</h3>
<p>
    A
    <code class="inline-code">BagDropTransactionTimeout</code>
    message displays on the Service Bus with an empty Message Body when too much
    time has elapsed since the
    <code class="inline-code">/bagdrop/v2/process</code>
    request was made.
</p>
<p>To resolve the issue:</p>
<ol>
    <li>
        <p>
            Right-click the bag in the SBD Device Simulator and select
            <strong>Remove</strong>.
        </p>
    </li>
    <li>
        <p>
            Check the Service Bus for a
            <code class="inline-code">StatusChanged</code>
            message which indicates the bag was removed. The device then goes
            <code class="inline-code">Offline</code>.
        </p>
    </li>

    <div class="method-example atom-one-light">
        <div class="method-example-top-bar">Service Bus Message</div>
        <pre><code class="language-json">
{
    "DeviceStatus":"Offline",
    "BagDropStatus":"BagRemovedUnexpectedly"
}     
        </code>
        </pre>
    </div>

    <p class="caption">
        <code class="inline-code">StatusChanged</code>
        Service Bus message indicating the bag was unexpectedly removed from the
        Processing area
    </p>
    <div class="alert-section info-alert">
        <div class="">
            <p>
                <strong>Note:</strong>
                In a bag drop process with a real SBD, unexpectedly removing the
                bag from the belt displays the same
                <code class="inline-code">BagDropStatus</code>.
            </p>
        </div>
    </div>

    <li>
        <p>Close the SBD Device Simulator Window.</p>
    </li>
    <li>
        <p>
            On the SBD Device in Device Simulator, click
            <strong>Run</strong>.
        </p>
        <ul>
            <li>A new SBD Device Simulator opens.</li>
            <li>
                An updated
                <code class="inline-code">BagdropDeviceStatus</code>
                message displays on the Service Bus, indicating the SBD is now
                <code class="inline-code">Online</code>.
            </li>
        </ul>
    </li>

    <div class="method-example atom-one-light">
        <div class="method-example-top-bar">Service Bus Message</div>
        <pre><code class="language-json">
{
    "DeviceStatus": "Online",
    "DeviceInUse": false
}
        </code>
        </pre>
    </div>

    <p class="caption">
        <code class="inline-code">BagdropDeviceStatus</code>
        Service Bus Message indicating the device is now
        <code class="inline-code">Online</code>
    </p>

    <li>
        Send a
        <code class="inline-code">/bagdrop/v2/getbag</code>
        request.
        <ul>
            <li>
                If successful, the Bagdrop API returns a
                <code class="inline-code">2xx</code>
                status code returns a successful
                <code class="inline-code">GetBagResponse</code>
                message on the Service Bus.
            </li>
        </ul>
    </li>
</ol>
<h2 id="simulate-a-customer-resolving-an-issue">
    Simulate a Customer Resolving an Issue
</h2>
<ol>
    <li>
        With the bag in the Process Area, send a
        <code class="inline-code">/bagdrop/v2/returnbag</code>
        to simulate the SBD returning the bag to the customer to resolve an
        issue.
        <ul>
            <li>
                The bag moves from the
                <strong>Processing Area</strong>
                back to the
                <strong>Entry Area</strong>
                and the door opens for a short period. If the door closes,
                sending another
                <code class="inline-code">/bagdrop/v2/returnbag</code>
                request will open the door again.
            </li>
            <li>
                A
                <code class="inline-code">DoorOpening</code>
                message displays on the Service Bus with an empty Message Body.
                This simply indicates the door of the SBD has opened so the bag
                can be accessible to the passenger to resolve the issue.
            </li>
            <li>
                A
                <code class="inline-code">BagChanged</code>
                message displays on the Service Bus which indicates the bag has
                changed
                <code class="inline-code">Position</code>
                from the
                <code class="inline-code">Process</code>
                area to the
                <code class="inline-code">Entry</code>
                area.
            </li>
            <li>
                A
                <code class="inline-code">ReturnBagResponse</code>
                message displays on the Service Bus which indicates the request
                to return the bag to the
                <code class="inline-code">Entry</code>
                position was successful (
                <code class="inline-code">"IsSuccess":true</code>).
            </li>
        </ul>
    </li>

    <p class="caption">
        SBD Device Simulator showing the bag has returned to the Entry Area
        where the customer can resolve the issue
    </p>
    <div class="alert-section info-alert">
        <div class="">
            <p>
                <strong>Note:</strong>
                In a real-life scenario, the customer would resolve a minor
                issue if no intervention is required by the agent.
            </p>
        </div>
    </div>

    <li>
        To simulate the customer having resolved the issue, send another
        <code class="inline-code">/bagdrop/v2/processbag</code>
        request to close the door and move the bag back the
        <strong>Processing Area</strong>.
    </li>
</ol>
<h2 id="simulate-an-agent-intervening-to-resolve-an-issue">
    Simulate an Agent Intervening to Resolve an Issue
</h2>
<ol>
    <li>
        With the bag in the Process Area, send a
        <code class="inline-code">/bagdrop/v2/cancelbag</code>
        request to simulate the bagdrop returning the bag due to an issue that
        requires agent assistance and cannot be resolved by the customer.
        <ul>
            <li>
                The bag moves from the
                <strong>Processing</strong>
                <strong>Area</strong>
                back to the
                <strong>Entry</strong>
                <strong>Area</strong>
                and the door opens for a short period.
            </li>
            <li>
                The same messages received on the Service Bus after sending a
                <code class="inline-code">/bagdrop/v2/returnbag</code>
                request are received after sending a
                <code class="inline-code">/bagdrop/v2/cancelbag</code>
                request. They indicate the bag has returned to the
                <strong>Entry</strong>
                <strong>Area</strong>.
            </li>
        </ul>
    </li>

    <p class="caption">
        SBD Device Simulator showing the bag has returned to the Entry Area
        where the agent can resolve the issue
    </p>
    <div class="alert-section info-alert">
        <div class="">
            <p>
                <strong>Note:</strong>
                In a real-life scenario, the agent would be alerted to resolve
                the issue at the SBD.
            </p>
        </div>
    </div>

    <li>
        To simulate the agent having resolved the issue, send another
        <code class="inline-code">/bagdrop/v2/processbag</code>
        request to close the door and move the bag back the
        <strong>Processing Area</strong>.
    </li>
</ol>
<h2 id="release-the-bag-to-the-bhs">Release the Bag to the BHS</h2>
<ol>
    <li>
        <p>
            With the bag in the
            <strong>Process</strong>
            Area, send a
            <code class="inline-code">/bagdrop/v2/releasebag</code>
            request to simulate the completion of the bagdrop process with the
            SBD unit releasing the bag.
        </p>
        <ul>
            <li>
                The bag moves from the
                <strong>Processing Area</strong>
                to the
                <strong>BHS Release Area</strong>
                where it will remain in the VM until it is removed.
            </li>
            <li>
                A
                <code class="inline-code">BagChanged</code>
                message displays on the Service Bus which indicates the bag's
                position has changed.
            </li>
            <li>
                A
                <code class="inline-code">ReleaseBagResponse</code>
                message displays on the Service Bus which indicates the request
                to release the bag to the BHS was successful (
                <code class="inline-code">"IsSuccess":true</code>).
            </li>
            <li>
                You can start a new bag drop process at this point by adding a
                new bag, sending a
                <code class="inline-code">/bagdrop/v2/getbag</code>
                request, then placing the new bag on the belt (performing the
                same process again).
            </li>
        </ul>
    </li>
</ol>

<p class="caption">
    SBD Device Simulator showing the bag has been successfully released to the
    BHS Release Area
</p>
<ul>
    <li>
        If you wish, you can start a new bag drop process at this point by
        adding a new bag, sending a
        <code class="inline-code">/bagdrop/v2/getbag</code>
        request, then placing the new bag on the belt.
    </li>
</ul>
<div class="continued-reading-section">
    <h2 class="continued-reading">Next Steps</h2>
    <ul class="continue-link-list">
        <div class="continue-link-row">
            <div class="svg-container">
                <svg
                    version="1.1"
                    id="Capa_1"
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    x="0px"
                    y="0px"
                    viewBox="0 0 482.204 482.204"
                    style="enable-background: new 0 0 482.204 482.204"
                    xml:space="preserve"
                >
                    <g>
                        <path
                            style="fill: #5469d4"
                            d="M83.127,344.477c54.602,1.063,101.919,9.228,136.837,23.613c0.596,0.244,1.227,0.366,1.852,0.366
                    c0.95,0,1.895-0.279,2.706-0.822c1.349-0.902,2.158-2.418,2.158-4.041l0.019-261.017c0-1.992-1.215-3.783-3.066-4.519
                    L85.019,42.899c-1.496-0.596-3.193-0.411-4.527,0.494c-1.334,0.906-2.133,2.413-2.133,4.025v292.197
                    C78.359,342.264,80.479,344.425,83.127,344.477z"
                        />
                        <path
                            style="fill: #5469d4"
                            d="M480.244,89.256c-1.231-0.917-2.824-1.198-4.297-0.759l-49.025,14.657
                    c-2.06,0.616-3.471,2.51-3.471,4.659v252.151c0,0,0.218,3.978-3.97,3.978c-4.796,0-7.946,0-7.946,0
                    c-39.549,0-113.045,4.105-160.93,31.6l-9.504,5.442l-9.503-5.442c-47.886-27.494-121.381-31.6-160.93-31.6c0,0-8.099,0-10.142,0
                    c-1.891,0-1.775-2.272-1.775-2.271V107.813c0-2.149-1.411-4.043-3.47-4.659L6.256,88.497c-1.473-0.439-3.066-0.158-4.298,0.759
                    S0,91.619,0,93.155v305.069c0,1.372,0.581,2.681,1.597,3.604c1.017,0.921,2.375,1.372,3.741,1.236
                    c14.571-1.429,37.351-3.131,63.124-3.131c56.606,0,102.097,8.266,131.576,23.913c4.331,2.272,29.441,15.803,41.065,15.803
                    c11.624,0,36.733-13.53,41.063-15.803c29.48-15.647,74.971-23.913,131.577-23.913c25.771,0,48.553,1.702,63.123,3.131
                    c1.367,0.136,2.725-0.315,3.742-1.236c1.016-0.923,1.596-2.231,1.596-3.604V93.155C482.203,91.619,481.476,90.173,480.244,89.256z
                    "
                        />
                        <path
                            style="fill: #5469d4"
                            d="M257.679,367.634c0.812,0.543,1.757,0.822,2.706,0.822c0.626,0,1.256-0.122,1.853-0.366
                    c34.917-14.386,82.235-22.551,136.837-23.613c2.648-0.052,4.769-2.213,4.769-4.861V47.418c0-1.613-0.799-3.12-2.133-4.025
                    c-1.334-0.904-3.031-1.09-4.528-0.494L258.569,98.057c-1.851,0.736-3.065,2.527-3.065,4.519l0.019,261.017
                    C255.521,365.216,256.331,366.732,257.679,367.634z"
                        />
                    </g>
                </svg>
            </div>
            <div>
                <a href="/print/overview">Print API</a>
            </div>
        </div>
        <div class="continue-link-row">
            <div class="svg-container">
                <svg
                    version="1.1"
                    id="Capa_1"
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    x="0px"
                    y="0px"
                    viewBox="0 0 482.204 482.204"
                    style="enable-background: new 0 0 482.204 482.204"
                    xml:space="preserve"
                >
                    <g>
                        <path
                            style="fill: #5469d4"
                            d="M83.127,344.477c54.602,1.063,101.919,9.228,136.837,23.613c0.596,0.244,1.227,0.366,1.852,0.366
                    c0.95,0,1.895-0.279,2.706-0.822c1.349-0.902,2.158-2.418,2.158-4.041l0.019-261.017c0-1.992-1.215-3.783-3.066-4.519
                    L85.019,42.899c-1.496-0.596-3.193-0.411-4.527,0.494c-1.334,0.906-2.133,2.413-2.133,4.025v292.197
                    C78.359,342.264,80.479,344.425,83.127,344.477z"
                        />
                        <path
                            style="fill: #5469d4"
                            d="M480.244,89.256c-1.231-0.917-2.824-1.198-4.297-0.759l-49.025,14.657
                    c-2.06,0.616-3.471,2.51-3.471,4.659v252.151c0,0,0.218,3.978-3.97,3.978c-4.796,0-7.946,0-7.946,0
                    c-39.549,0-113.045,4.105-160.93,31.6l-9.504,5.442l-9.503-5.442c-47.886-27.494-121.381-31.6-160.93-31.6c0,0-8.099,0-10.142,0
                    c-1.891,0-1.775-2.272-1.775-2.271V107.813c0-2.149-1.411-4.043-3.47-4.659L6.256,88.497c-1.473-0.439-3.066-0.158-4.298,0.759
                    S0,91.619,0,93.155v305.069c0,1.372,0.581,2.681,1.597,3.604c1.017,0.921,2.375,1.372,3.741,1.236
                    c14.571-1.429,37.351-3.131,63.124-3.131c56.606,0,102.097,8.266,131.576,23.913c4.331,2.272,29.441,15.803,41.065,15.803
                    c11.624,0,36.733-13.53,41.063-15.803c29.48-15.647,74.971-23.913,131.577-23.913c25.771,0,48.553,1.702,63.123,3.131
                    c1.367,0.136,2.725-0.315,3.742-1.236c1.016-0.923,1.596-2.231,1.596-3.604V93.155C482.203,91.619,481.476,90.173,480.244,89.256z
                    "
                        />
                        <path
                            style="fill: #5469d4"
                            d="M257.679,367.634c0.812,0.543,1.757,0.822,2.706,0.822c0.626,0,1.256-0.122,1.853-0.366
                    c34.917-14.386,82.235-22.551,136.837-23.613c2.648-0.052,4.769-2.213,4.769-4.861V47.418c0-1.613-0.799-3.12-2.133-4.025
                    c-1.334-0.904-3.031-1.09-4.528-0.494L258.569,98.057c-1.851,0.736-3.065,2.527-3.065,4.519l0.019,261.017
                    C255.521,365.216,256.331,366.732,257.679,367.634z"
                        />
                    </g>
                </svg>
            </div>
            <div>
                <a href="/scan/overview">Scan API</a>
            </div>
        </div>

        <div class="continue-link-row">
            <div class="svg-container">
                <svg
                    version="1.1"
                    id="Capa_1"
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    x="0px"
                    y="0px"
                    viewBox="0 0 482.204 482.204"
                    style="enable-background: new 0 0 482.204 482.204"
                    xml:space="preserve"
                >
                    <g>
                        <path
                            style="fill: #5469d4"
                            d="M83.127,344.477c54.602,1.063,101.919,9.228,136.837,23.613c0.596,0.244,1.227,0.366,1.852,0.366
                    c0.95,0,1.895-0.279,2.706-0.822c1.349-0.902,2.158-2.418,2.158-4.041l0.019-261.017c0-1.992-1.215-3.783-3.066-4.519
                    L85.019,42.899c-1.496-0.596-3.193-0.411-4.527,0.494c-1.334,0.906-2.133,2.413-2.133,4.025v292.197
                    C78.359,342.264,80.479,344.425,83.127,344.477z"
                        />
                        <path
                            style="fill: #5469d4"
                            d="M480.244,89.256c-1.231-0.917-2.824-1.198-4.297-0.759l-49.025,14.657
                    c-2.06,0.616-3.471,2.51-3.471,4.659v252.151c0,0,0.218,3.978-3.97,3.978c-4.796,0-7.946,0-7.946,0
                    c-39.549,0-113.045,4.105-160.93,31.6l-9.504,5.442l-9.503-5.442c-47.886-27.494-121.381-31.6-160.93-31.6c0,0-8.099,0-10.142,0
                    c-1.891,0-1.775-2.272-1.775-2.271V107.813c0-2.149-1.411-4.043-3.47-4.659L6.256,88.497c-1.473-0.439-3.066-0.158-4.298,0.759
                    S0,91.619,0,93.155v305.069c0,1.372,0.581,2.681,1.597,3.604c1.017,0.921,2.375,1.372,3.741,1.236
                    c14.571-1.429,37.351-3.131,63.124-3.131c56.606,0,102.097,8.266,131.576,23.913c4.331,2.272,29.441,15.803,41.065,15.803
                    c11.624,0,36.733-13.53,41.063-15.803c29.48-15.647,74.971-23.913,131.577-23.913c25.771,0,48.553,1.702,63.123,3.131
                    c1.367,0.136,2.725-0.315,3.742-1.236c1.016-0.923,1.596-2.231,1.596-3.604V93.155C482.203,91.619,481.476,90.173,480.244,89.256z
                    "
                        />
                        <path
                            style="fill: #5469d4"
                            d="M257.679,367.634c0.812,0.543,1.757,0.822,2.706,0.822c0.626,0,1.256-0.122,1.853-0.366
                    c34.917-14.386,82.235-22.551,136.837-23.613c2.648-0.052,4.769-2.213,4.769-4.861V47.418c0-1.613-0.799-3.12-2.133-4.025
                    c-1.334-0.904-3.031-1.09-4.528-0.494L258.569,98.057c-1.851,0.736-3.065,2.527-3.065,4.519l0.019,261.017
                    C255.521,365.216,256.331,366.732,257.679,367.634z"
                        />
                    </g>
                </svg>
            </div>
            <div>
                <a href="/gateAccess/overview">GateAccess API</a>
            </div>
        </div>
        <div class="continue-link-row">
            <div class="svg-container">
                <svg
                    version="1.1"
                    id="Capa_1"
                    xmlns="http://www.w3.org/2000/svg"
                    xmlns:xlink="http://www.w3.org/1999/xlink"
                    x="0px"
                    y="0px"
                    viewBox="0 0 482.204 482.204"
                    style="enable-background: new 0 0 482.204 482.204"
                    xml:space="preserve"
                >
                    <g>
                        <path
                            style="fill: #5469d4"
                            d="M83.127,344.477c54.602,1.063,101.919,9.228,136.837,23.613c0.596,0.244,1.227,0.366,1.852,0.366
                    c0.95,0,1.895-0.279,2.706-0.822c1.349-0.902,2.158-2.418,2.158-4.041l0.019-261.017c0-1.992-1.215-3.783-3.066-4.519
                    L85.019,42.899c-1.496-0.596-3.193-0.411-4.527,0.494c-1.334,0.906-2.133,2.413-2.133,4.025v292.197
                    C78.359,342.264,80.479,344.425,83.127,344.477z"
                        />
                        <path
                            style="fill: #5469d4"
                            d="M480.244,89.256c-1.231-0.917-2.824-1.198-4.297-0.759l-49.025,14.657
                    c-2.06,0.616-3.471,2.51-3.471,4.659v252.151c0,0,0.218,3.978-3.97,3.978c-4.796,0-7.946,0-7.946,0
                    c-39.549,0-113.045,4.105-160.93,31.6l-9.504,5.442l-9.503-5.442c-47.886-27.494-121.381-31.6-160.93-31.6c0,0-8.099,0-10.142,0
                    c-1.891,0-1.775-2.272-1.775-2.271V107.813c0-2.149-1.411-4.043-3.47-4.659L6.256,88.497c-1.473-0.439-3.066-0.158-4.298,0.759
                    S0,91.619,0,93.155v305.069c0,1.372,0.581,2.681,1.597,3.604c1.017,0.921,2.375,1.372,3.741,1.236
                    c14.571-1.429,37.351-3.131,63.124-3.131c56.606,0,102.097,8.266,131.576,23.913c4.331,2.272,29.441,15.803,41.065,15.803
                    c11.624,0,36.733-13.53,41.063-15.803c29.48-15.647,74.971-23.913,131.577-23.913c25.771,0,48.553,1.702,63.123,3.131
                    c1.367,0.136,2.725-0.315,3.742-1.236c1.016-0.923,1.596-2.231,1.596-3.604V93.155C482.203,91.619,481.476,90.173,480.244,89.256z
                    "
                        />
                        <path
                            style="fill: #5469d4"
                            d="M257.679,367.634c0.812,0.543,1.757,0.822,2.706,0.822c0.626,0,1.256-0.122,1.853-0.366
                    c34.917-14.386,82.235-22.551,136.837-23.613c2.648-0.052,4.769-2.213,4.769-4.861V47.418c0-1.613-0.799-3.12-2.133-4.025
                    c-1.334-0.904-3.031-1.09-4.528-0.494L258.569,98.057c-1.851,0.736-3.065,2.527-3.065,4.519l0.019,261.017
                    C255.521,365.216,256.331,366.732,257.679,367.634z"
                        />
                    </g>
                </svg>
            </div>
            <div>
                <a href="/payment/overview">Payment API</a>
            </div>
        </div>
    </ul>
</div>
