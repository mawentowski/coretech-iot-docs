<h2 id="service-bus-messages">Service Bus Messages</h2>
<p>
    The following is not an exhaustive list of all possible Service Bus
    <code class="inline-code">Message Types</code>. Only the most common ones
    encountered when sending Print API requests are described.
</p>
<h3 id="printdevicestatus">PrintDeviceStatus</h3>
<h4 id="devicestatus-is-online">
    <code class="inline-code">DeviceStatus</code> is
    <code class="inline-code">Online</code>
</h4>
<p>
    After you connect to a print device, a
    <code class="inline-code">PrintDeviceStatus</code> message is displayed on
    the Service Bus that should indicate the
    <code class="inline-code">DeviceStatus</code> is
    <code class="inline-code">Online</code>.
</p>
<pre><code class="language-JSON">{
    "DeviceStatus": "Online",
    "MediaStatus": "Ok",
    "BinStatus": "Ok"
}
</code></pre>
<h5
    id="printdevicestatus-service-bus-message-showing-the-print-device-is-online"
>
    <code class="inline-code">PrintDeviceStatus</code> Service Bus Message
    showing the Print device is <code class="inline-code">Online</code>
</h5>
<h4 id="devicestatus-changes">
    <code class="inline-code">DeviceStatus</code> Changes
</h4>
<p>
    If the device&#39;s status changes for whatever reason (for example, the
    device goes <code class="inline-code">Offline</code> or the paper becomes
    jammed), a <code class="inline-code">DeviceStatus</code> message may display
    after requesting a print followed by an unsuccessful
    <code class="inline-code">PrintResponse</code> message.
</p>
<pre><code class="language-json">{
    "DeviceStatus": "Online",
    "MediaStatus": "Jammed",
    "BinStatus": "Ok"
}
</code></pre>
<h5
    id="devicestatus-service-bus-message-sent-after-requesting-a-print-on-a-printer-with-a-paper-jam"
>
    <code class="inline-code">DeviceStatus</code> Service Bus Message sent after
    requesting a print on a printer with a paper jam
</h5>
<h3 id="printresponse">PrintResponse</h3>
<p>
    After sending a request to print to a device, the
    <code class="inline-code">PrintResponse</code> is the primary
    <code class="inline-code">MessageType</code> received on the Service Bus
    after making a print request. It is virtually identical across devices and
    print formats. Its sole purpose to indicate if the print was successful and
    how many documents were printed.
</p>
<p>
    Upon making a <span class="method post">POST</span>
    <code class="inline-code">/print/v2/</code> request, the Print API
    acknowledges the request with a synchronous message, returning a
    <code class="inline-code">2xx</code> success status code no matter if the
    print was successful or unsuccessful. It merely indicates the Print API
    successfully sent the request.
</p>
<p>
    The API takes the <code class="inline-code">ConnectionId</code> and looks up
    the details associated with the ID, most notably the
    <code class="inline-code">DeviceId</code>. The
    <code class="inline-code">DeviceID</code> is sent to IoT Hub where is it
    routed to the correct workstation to carry out the command on the peripheral
    (for example, printing).
</p>
<p>
    The Print API then routes the messages to the Service Bus topic for sending
    messages to airlines ( <code class="inline-code">airline-messages</code>),
    returned as <code class="inline-code">MessageData</code> in the
    <strong>Message Body</strong>.
    <code class="inline-code">MessageData</code> indicates if the request was
    successful.
</p>
<p>
    A successful print returns a
    <code class="inline-code">PrintResponse</code> message with
    <code class="inline-code">IsSuccess</code> set to
    <code class="inline-code">true</code>, in which case the number of
    successful prints is returned.
</p>
<pre><code class="language-JSON">{
    "IsSuccess": true,
    "Error": null,
    "SuccessfulPrints": "1"
}
</code></pre>
<p class="caption">
    <code class="inline-code">PrintResponse</code> Service Bus Message
    indicating a successful print
</h5>
<p>
    For an unsuccessful print, a
    <code class="inline-code">PrintResponse</code> message displays with
    <code class="inline-code">IsSuccess</code> set to
    <code class="inline-code">false</code> in the Message Body. An
    <code class="inline-code">ErrorCode</code> and
    <code class="inline-code">Message</code> are returned. In this case, the
    reason for the failed print request is that the printer is jammed.
</p>
<pre><code class="language-JSON">{
    "IsSuccess": false,
    "Error": {
        "ErrorCode": "NotAbleToPrint",
        "Message": "PrintNotOk/UnSuccessfulPrint, with Jammed"
    },
    "SuccessfulPrints": "0"
}
</code></pre>
<h5
    id="printresponse-service-bus-message-indicating-an-unsuccessful-print-due-to-paper-jam"
>
    <code class="inline-code">PrintResponse</code> Service Bus Message
    indicating an unsuccessful print due to paper jam
</h5>
<div class="alert-section info-alert">
    <div class="">
        <p>
            The actual text contained in the error
            <code class="inline-code">Message</code> is determined by the
            software on the workstation.
        </p>
    </div>
    <p>
        The resolution would be to physically locate the printer, unjam the
        paper, then attempt to send another print request.
    </p>
</div>
