<div class="title-box">
    <h1 class="topic-title">Complete Transaction</h1>
    <div class="action-statement">
        Confirm payment was successful and the payment transaction has completed
    </div>
</div>

<p>
    Send a <span class="method post">POST</span>
   <code class="inline-code">/payment/v2/completetransaction</code> request to acknowledge the payment
    transaction has completed.
</p>




<h2>Make an API Call</h2>

<div class="alert-section info-alert">
    <div class="">
        For information on the common components that make up a request, like the Resource URL, Header Parameters, or the Authorization Header, see <a href="/payment/payment-api-call-components">API Call Components</a>.

    </div>
</div>



<div class="code-section with-tabs">
    <div class="code-section-header">
        <div class="code-tabs">
            <button class="tablinks" onclick="openTab(event, 'bash -complete-transaction')" id="defaultOpen">curl</button>
            <button class="tablinks" onclick="openTab(event, 'Ruby -complete-transaction')">Ruby</button>
            <button class="tablinks" onclick="openTab(event, 'Python -complete-transaction')">Python</button>
            <button class="tablinks" onclick="openTab(event, 'PHP -complete-transaction')">PHP</button>
            <button class="tablinks" onclick="openTab(event, 'Java -complete-transaction')">Java</button>
            <button class="tablinks" onclick="openTab(event, 'Node -complete-transaction')">Node</button>
            <button class="tablinks" onclick="openTab(event, 'Go -complete-transaction')">Go</button>
            <button class="tablinks" onclick="openTab(event, '.NET -complete-transaction')">.NET</button>
        </div>
        <div class="copy-code-btn-container">
            <button class="copy-code-btn">
                <svg
                viewBox="0 0 1000 1000"
                height="20"
                width="20"
                xmlns="http://www.w3.org/2000/svg"
                role="img"
              >
                <title>Copy to Clipboard</title>
                <path d="M704 896H64V320h640v192h64V192c0-35-29-64-64-64H512C512 57 455 0 384 0S256 57 256 128H64c-35 0-64 29-64 64v704c0 35 29 64 64 64h640c35 0 64-29 64-64V768h-64v128zM192 192h64s64-29 64-64 29-64 64-64 64 29 64 64 32 64 64 64h64s64 29 64 64H128c0-39 28-64 64-64zm-64 512h128v-64H128v64zm448-128V448L320 640l256 192V704h320V576H576zM128 832h192v-64H128v64zm320-448H128v64h320v-64zM256 512H128v64h128v-64z"
                />
              </svg>
              
            </button>
        </div>

    </div>
    <div class="copied-popup hidden">
        Copied!
    </div>

<div id="bash -complete-transaction" class="tabcontent dark"><pre> <code>
curl --location -g --request POST 'https://{{baseurl}}/payment/v2/completetransaction' \
--header 'Content-Type: application/json' \
--data-raw '{   
    "connectionId": "{{pmc_connection_id}}",
    "correlationId": "correl_paymt"
}'
</code>
</pre>
</div>

<div id="Ruby -complete-transaction" class="tabcontent dark"><pre><code>
require "uri"
require "json"
require "net/http"

url = URI("https://{{baseurl}}/payment/v2/completetransaction")

https = Net::HTTP.new(url.host, url.port)
https.use_ssl = true

request = Net::HTTP::Post.new(url)
request["Content-Type"] = "application/json"
request.body = JSON.dump({
    "connectionId": "{{pmc_connection_id}}",
    "correlationId": "correl_paymt"
})

response = https.request(request)
puts response.read_body    
</code>
</pre>
</div>

<div id="Python -complete-transaction" class="tabcontent dark"><pre> <code>
import requests
import json

url = "https://{{baseurl}}/payment/v2/completetransaction"

payload = json.dumps({
    "connectionId": "{{pmc_connection_id}}",
    "correlationId": "correl_paymt"
})
headers = {
    'Content-Type': 'application/json'
}

response = requests.request("POST", url, headers=headers, data=payload)

print(response.text)         
</code>
</pre>
</div>

<div id="PHP -complete-transaction" class="tabcontent dark"><pre> <code>
    <?php

    $curl = curl_init();
    
    curl_setopt_array($curl, array(
      CURLOPT_URL => 'https://%7B%7Bbaseurl%7D%7D/payment/v2/completetransaction',
      CURLOPT_RETURNTRANSFER => true,
      CURLOPT_ENCODING => '',
      CURLOPT_MAXREDIRS => 10,
      CURLOPT_TIMEOUT => 0,
      CURLOPT_FOLLOWLOCATION => true,
      CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
      CURLOPT_CUSTOMREQUEST => 'POST',
      CURLOPT_POSTFIELDS =>'{   
      "connectionId": "{{pmc_connection_id}}",
      "correlationId": "correl_paymt"
    }',
      CURLOPT_HTTPHEADER => array(
        'Content-Type: application/json'
      ),
    ));
    
    $response = curl_exec($curl);
    
    curl_close($curl);
    echo $response;    
</code>
</pre>
</div>

<div id="Java -complete-transaction" class="tabcontent dark"><pre><code>
Unirest.setTimeouts(0, 0);
HttpResponse<String> response = Unirest.post("https://{{baseurl}}/payment/v2/completetransaction")
    .header("Content-Type", "application/json")
    .body("{   \r\n  \"connectionId\": \"{{pmc_connection_id}}\",\r\n  \"correlationId\": \"correl_paymt\"\r\n}")
    .asString();   

</code>
</pre>
</div>

<div id="Node -complete-transaction" class="tabcontent dark"><pre><code>
var request = require('request');
var options = {
    'method': 'POST',
    'url': 'https://{{baseurl}}/payment/v2/completetransaction',
    'headers': {
    'Content-Type': 'application/json'
    },
    body: JSON.stringify({
    "connectionId": "{{pmc_connection_id}}",
    "correlationId": "correl_paymt"
    })

};
request(options, function (error, response) {
    if (error) throw new Error(error);
    console.log(response.body);
});     
</code>
</pre>
</div>

<div id="Go -complete-transaction" class="tabcontent dark"><pre><code>
package main

import (
    "fmt"
    "strings"
    "net/http"
    "io/ioutil"
)

func main() {

    url := "https://%7B%7Bbaseurl%7D%7D/payment/v2/completetransaction"
    method := "POST"

    payload := strings.NewReader(`{   `+"
"+`
    "connectionId": "{{pmc_connection_id}}",`+"
"+`
    "correlationId": "correl_paymt"`+"
"+`
}`)

    client := &http.Client {
    }
    req, err := http.NewRequest(method, url, payload)

    if err != nil {
    fmt.Println(err)
    return
    }
    req.Header.Add("Content-Type", "application/json")

    res, err := client.Do(req)
    if err != nil {
    fmt.Println(err)
    return
    }
    defer res.Body.Close()

    body, err := ioutil.ReadAll(res.Body)
    if err != nil {
    fmt.Println(err)
    return
    }
    fmt.Println(string(body))
}
</code>
</pre>
</div>

<div id=".NET -complete-transaction" class="tabcontent dark"><pre><code>
var client = new RestClient("https://{{baseurl}}/payment/v2/completetransaction");
client.Timeout = -1;
var request = new RestRequest(Method.POST);
request.AddHeader("Content-Type", "application/json");
var body = @"{   
" + "\n" +
@"  ""connectionId"": ""{{pmc_connection_id}}"",
" + "\n" +
@"  ""correlationId"": ""correl_paymt""
" + "\n" +
@"}";
request.AddParameter("application/json", body,  ParameterType.RequestBody);
IRestResponse response = client.Execute(request);
Console.WriteLine(response.Content);    
</code>
</pre>
</div>

</div>

<p class="caption">
    Sample <span class="method post">POST</span>
   <code class="inline-code">/payment/v2/completetransaction</code> request to acknowledge the payment
    transaction has completed.
</p>





<h2>Request Body</h2>
<p>The following is a sample Request Body for <action> using an PMC device.</p>

    <div class="method-example atom-one-light">
        <div class="method-example-top-bar">Request Body</div>
        <pre>
                <code class="language-json">
{
    "connectionId": "{{pmc_connection_id}}",
    "verified": true,
    "correlationId" : "correl_paymt"
}
            </code>
            </pre>
    </div>

<h2>Response</h2>
<p>
    Once a payment transaction has completed, a
    <code class="inline-code">TransactionCompleted</code> message displays on
    the Service Bus. 
</p>
<p>
    A <span class="method post">POST</span>
    <code class="inline-code">/payment/v2/completetransaction</code>
    must be made to acknowledge that the transaction has completed.
</p>


